/* ========================================
   VARIABLES ET STYLES DE BASE
   ======================================== */

/* Variables CSS pour les breakpoints */
:root {
  --breakpoint-mobile: 600px;
  --breakpoint-tablet: 768px;
  --breakpoint-desktop: 900px;
  --transition-fast: 0.2s ease;
  --transition-normal: 0.3s ease;
  --transition-slow: 0.4s ease;
  --menu-z-index: 1002;
  --overlay-z-index: 1001;
}

/* ========================================
   COMPOSANTS MENU HAMBURGER
   ======================================== */

.header-right {
  display: flex;
  align-items: center;
  gap: var(--space-m);
}

.menu-hamburger {
  display: flex;
  align-items: center;
  justify-content: center;
  margin-right: auto;
}

.menu-toggle {
  display: none;
  background: none;
  border: none;
  cursor: pointer;
  padding: var(--space-xs);
  border-radius: var(--radius);
  transition: background-color var(--transition-normal), transform var(--transition-fast);
  width: 44px;
  height: 44px;
  align-items: center;
  justify-content: center;
  margin-right: auto;
  position: relative;
}

.menu-toggle:hover {
  background: var(--color-hover);
}

/* Icône hamburger et animation */
.hamburger-icon {
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  width: 24px;
  height: 18px;
}

.hamburger-icon .bar {
  display: block;
  width: 100%;
  height: 3px;
  background-color: var(--color-primary);
  border-radius: 2px;
  transition: transform var(--transition-normal), opacity var(--transition-normal);
}

/* Animation hamburger → X */
.menu-toggle[aria-expanded="true"] .hamburger-icon .bar:nth-child(1) {
  transform: translateY(7.5px) rotate(45deg);
}

.menu-toggle[aria-expanded="true"] .hamburger-icon .bar:nth-child(2) {
  opacity: 0;
}

.menu-toggle[aria-expanded="true"] .hamburger-icon .bar:nth-child(3) {
  transform: translateY(-7.5px) rotate(-45deg);
}

/* Overlay de fond */
.menu-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.5);
  opacity: 0;
  visibility: hidden;
  transition: opacity var(--transition-normal), visibility var(--transition-normal);
  z-index: var(--overlay-z-index);
  backdrop-filter: blur(5px);
  -webkit-backdrop-filter: blur(5px);
}

.menu-overlay.show {
  opacity: 1;
  visibility: visible;
}

/* ========================================
   ANIMATIONS
   ======================================== */

@keyframes slideInFromLeft {
  from {
    opacity: 0;
    transform: translateX(-30px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

/* ========================================
   RESPONSIVE - DESKTOP FIRST
   ======================================== */

/* Tablettes et écrans moyens (900px et moins) */
@media (max-width: 900px) {
  main {
    flex-direction: column;
  }
  
  header {
    grid-template-areas: 
      "left right"
      "menu menu";
    grid-template-columns: 1fr auto;
  }
  
  .header-left {
    justify-content: center;
  }
	
	.forum {
		padding-top: 3em;
	}
}

/* Transition tablette → mobile (768px et moins) */
@media (max-width: 768px) {
  /* Réorganisation du header */
  header {
    grid-template-areas: 
      "left"
      "right"
      "menu";
    grid-template-columns: 1fr;
    grid-template-rows: auto auto auto;
  }
  
  .header-left {
    padding-left: 0;
  }
  
  /* Affichage du menu hamburger */
  .menu-toggle {
    display: flex;
  }
  
  /* Réinitialisation de la navigation principale */
  .main-nav {
    position: relative !important;
    top: auto;
    left: auto;
    width: 100%;
    padding: 0;
    height: 0;
    z-index: var(--menu-z-index);
  }
  
  .main-nav:not(.in-header) {
    border-radius: var(--radius);
    margin: 0 auto var(--space-m) auto;
    max-width: var(--max-width-blocs);
    background: var(--color-surface);
    backdrop-filter: none;
    -webkit-backdrop-filter: none;
    border-bottom: none;
    box-shadow: var(--shadow);
    animation: none;
  }
  
  /* Menu en overlay mobile */
  .awi-hmenu {
    position: fixed;
    top: -15px;
    left: 0;
    width: 100%;
    background: var(--color-surface);
    display: flex;
    flex-direction: column;
    padding: var(--space-m);
    overflow-y: auto;
    transform: translateX(-100%);
    transition: transform var(--transition-slow) cubic-bezier(0.25, 0.46, 0.45, 0.94);
    opacity: 0;
    visibility: hidden;
  }
  
  .awi-hmenu.show {
    transform: translateX(0);
    opacity: 1;
    visibility: visible;
  }
  
  /* Éléments du menu principal */
  .awi-hmenu > li {
    width: 100%;
    margin: 0 0 var(--space-s) 0;
    border-bottom: 1px solid var(--color-border);
    padding-bottom: var(--space-s);
  }
  
  .awi-hmenu > li:last-child {
    border-bottom: none;
    margin-bottom: 0;
  }
  
  .awi-hmenu > li > a {
    width: 100%;
    justify-content: flex-start;
    padding: var(--space-s) 0;
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--color-text);
    background: none;
    border-radius: 0;
    text-transform: none;
    letter-spacing: normal;
    transition: color var(--transition-normal), transform var(--transition-normal);
  }
  
  .awi-hmenu > li > a:hover {
    color: var(--color-primary);
    background: none;
    transform: translateX(var(--space-s));
  }
  
  .awi-hmenu > li > a i {
    margin-right: var(--space-s);
    font-size: 1.1em;
    width: 20px;
    color: var(--color-primary);
  }
  
  /* Sous-menus */
  .awi-hmenu li ul.level2 {
    position: static;
    opacity: 1;
    visibility: visible;
    transform: none;
    box-shadow: none;
    max-height: 0;
    overflow: hidden;
    transition: max-height var(--transition-slow), padding var(--transition-slow);
    margin: var(--space-xs) 0 0 0;
    padding: 0;
    border: none;
    background: transparent;
    border-radius: 0;
    border-left: 3px solid var(--color-primary);
    padding-left: var(--space-m);
  }
  
  .awi-hmenu li:hover > ul.level2,
  .awi-hmenu li:focus-within > ul.level2,
  .awi-hmenu li.active > ul.level2 {
    max-height: 800px;
    padding: var(--space-xs) 0 0 var(--space-m);
  }
  
  .awi-hmenu li ul.level2 li {
    margin: 0;
    border-bottom: none;
    padding: 0;
  }
  
  .awi-hmenu li ul.level2 li a {
    text-align: left;
    justify-content: flex-start;
    padding: var(--space-xs) 0;
    font-size: 0.95rem;
    font-weight: 400;
    color: var(--color-text-secondary);
    background: none;
    border-radius: 0;
    margin: 0;
    transition: color var(--transition-normal), transform var(--transition-normal);
  }
  
  .awi-hmenu li ul.level2 li a:hover {
    color: var(--color-primary);
    background: none;
    transform: translateX(var(--space-xs));
    padding-left: 0;
  }
  
  .awi-hmenu li ul.level2 li a i {
    margin-right: var(--space-s);
    font-size: 0.9em;
    opacity: 0.7;
  }
  
  /* Gestion du body */
  body {
    padding-top: 0 !important;
  }
  
  body.menu-open {
    overflow: hidden;
    position: fixed;
    width: 100%;
  }
  
  /* Animation des éléments du menu */
  .awi-hmenu.show > li {
    animation: slideInFromLeft 0.6s ease-out forwards;
    opacity: 0;
  }
  
  .awi-hmenu.show > li:nth-child(1) { animation-delay: 0.1s; }
  .awi-hmenu.show > li:nth-child(2) { animation-delay: 0.15s; }
  .awi-hmenu.show > li:nth-child(3) { animation-delay: 0.2s; }
  .awi-hmenu.show > li:nth-child(4) { animation-delay: 0.25s; }
  .awi-hmenu.show > li:nth-child(5) { animation-delay: 0.3s; }
  .awi-hmenu.show > li:nth-child(6) { animation-delay: 0.35s; }
  
  /* Mode sombre */
  html.darkmode .awi-hmenu,
  html:not(.lightmode):not(.darkmode) .awi-hmenu {
    background: var(--color-bg);
  }
  
  /* Corrections spécifiques tablettes */
  #avatardUser img {
    padding-bottom: 0 !important;
  }
  
  #encartForum table tr:first-child th, 
  #encartForum table tr.newFirst th, 
  #encartForum table td, 
  #encartForum table th {
    border: none;
    border-bottom: 1px solid var(--color-border);
  }
  
  #randomCR ul {
    padding-left: 1em;
  }
  
  #encartLanIndex, 
  #randomCR {
    padding-left: 15px;
  }
  
  .spacerIndex, 
  #encartLanIndex > div:nth-child(3) {
    margin-top: -1.5em;
  }
}

/* Mobile (600px et moins) */
@media (max-width: 600px) {
  /* Variables mobiles */
  :root {
    --space-m: 12px;
    --space-l: 20px;
  }
  
  /* Espacement mobile */
  header, 
  .main-content, 
  .sidebar, 
  .card, 
  footer {
    padding: var(--space-s);
  }
  
  /* Éléments de contenu */
  blockquote {
    margin: var(--space-s) var(--space-xs) var(--space-s) var(--space-s);
    padding: var(--space-s) var(--space-s) var(--space-s) calc(var(--space-m) + 8px);
  }
  
  pre,
  div.code {
    font-size: 0.92em;
    padding: var(--space-xs) var(--space-xs);
  }
  
  /* Zone de recherche */
  .search-active .search-zone {
    width: 80%;
  }
}

/* Très petits écrans (480px et moins) */
@media (max-width: 480px) {
  .awi-hmenu {
    padding: var(--space-m);
  }
  
  .awi-hmenu > li > a {
    font-size: 1rem;
  }
  
  .menu-toggle {
    width: 40px;
    height: 40px;
  }
  
  .logo {
    height: 40px;
  }
  
  .site-title h1 {
    font-size: 1.2rem;
  }
  
  .slogan {
    font-size: 0.8rem;
  }
}

/* ========================================
   PROTECTION DESKTOP (769px et plus)
   ======================================== */

@media (min-width: 769px) {
  .menu-toggle {
    display: none !important;
  }
  
  .menu-overlay {
    display: none !important;
  }
  
  .awi-hmenu {
    position: static !important;
    transform: none !important;
    opacity: 1 !important;
    visibility: visible !important;
    height: auto !important;
    background: transparent !important;
    padding: 0 !important;
    overflow: visible !important;
  }
}

/* ========================================
   MEDIA QUERIES SPÉCIFIQUES LEGACY
   ======================================== */

/* Support tablettes legacy */
@media only screen and (max-width: 760px),
(min-device-width: 768px) and (max-device-width: 1024px) {
  #avatardUser img {
    padding-bottom: 0 !important;
  }
  
  #encartForum table tr:first-child th, 
  #encartForum table tr.newFirst th, 
  #encartForum table td, 
  #encartForum table th {
    border: none;
    border-bottom: 1px solid var(--color-border);
  }
  
  #randomCR ul {
    padding-left: 1em;
  }
  
  #encartLanIndex, 
  #randomCR {
    padding-left: 15px;
  }
  
  .spacerIndex, 
  #encartLanIndex > div:nth-child(3) {
    margin-top: -1.5em;
  }
}